# QLineSec

# Kime ait?
**ZÃ¼hrenaz MÄ±sÄ±r**
**2420191009** 

# Multi-Protocol IDS (Intrusion Detection System)

GerÃ§ek zamanlÄ± Ã§oklu protokol saldÄ±rÄ± tespit sistemi.

## ğŸš€ Ã–zellikler

- **Ã‡oklu Protokol DesteÄŸi**: HTTP/1.1-2, GraphQL, WebSocket
- **SaldÄ±rÄ± Tespiti**: SQL Injection, XSS, Complexity Attack, Protocol Abuse
- **Yakalama ModlarÄ±**:
  - ğŸ“¡ PCAP - Raw aÄŸ paketi yakalama (root gerekli)
  - ğŸŒ HTTP Proxy - Araya girme (root gerekmez)
  - ğŸ“„ Log Parser - Nginx/Apache log analizi
- **Ã‡Ä±ktÄ± FormatlarÄ±**: Text, JSON, CSV
- **Config DosyasÄ±**: YAML/JSON desteÄŸi

## ğŸ“¦ Kurulum

```bash
# Temel kurulum
cd /home/zuhre/Desktop/projectz
pip install -r requirements.txt

# Opsiyonel (YAML config iÃ§in)
pip install pyyaml

# Opsiyonel (Interface listesi iÃ§in)
pip install netifaces
```

## ğŸ¯ HÄ±zlÄ± BaÅŸlangÄ±Ã§

```bash
# Demo modu - simÃ¼le saldÄ±rÄ± trafiÄŸi
python3 -m ids.main --demo

# YardÄ±m
python3 -m ids.main --help
```

## ğŸ“‹ KullanÄ±m Ã–rnekleri

### 1. Demo Modu

```bash
# Basit demo
python3 -m ids.main --demo

# JSON Ã§Ä±ktÄ±
python3 -m ids.main --demo --output json

# DetaylÄ± Ã§Ä±ktÄ±
python3 -m ids.main --demo -vv
```

### 2. HTTP Proxy (Root Gerektirmez âœ“)

```bash
# Tek port
python3 -m ids.main --capture-proxy --port 8888

# Birden fazla port
python3 -m ids.main --capture-proxy --ports 80,443,8080

# TÃ¼m interface'lerde dinle
python3 -m ids.main --capture-proxy --ports 8888 --host 0.0.0.0

# Test
curl -x http://localhost:8888 "http://example.com/api?id=1 OR 1=1--"
```

### 3. Log Parser (Root Gerektirmez âœ“)

```bash
# Nginx log
python3 -m ids.main --parse-log /var/log/nginx/access.log

# Apache log
python3 -m ids.main --parse-log /var/log/apache2/access.log --log-format apache

# Birden fazla dosya
python3 -m ids.main --parse-log access.log error.log other.log

# CanlÄ± izleme (tail -f)
python3 -m ids.main --parse-log /var/log/nginx/access.log --watch
```

### 4. PCAP Yakalama (Root Gerekli âš ï¸)

```bash
# Belirli interface
sudo python3 -m ids.main --capture-pcap --interface eth0

# TÃ¼m interface'ler
sudo python3 -m ids.main --capture-pcap --interface any

# Port filtresi
sudo python3 -m ids.main --capture-pcap --interface eth0 --filter-port 80
```

### 5. Config DosyasÄ±

```bash
# Ã–rnek config oluÅŸtur
python3 -m ids.main --generate-config

# Config ile Ã§alÄ±ÅŸtÄ±r
python3 -m ids.main --config config.yaml
```

## âš™ï¸ Config DosyasÄ± Ã–rneÄŸi (config.yaml)

```yaml
capture:
  mode: proxy
  interface: any
  ports: [80, 443, 8080, 8888]
  host: 0.0.0.0
  log_files: []
  log_format: auto
  watch: false

output:
  format: text
  log_dir: ./logs
  log_file: security_events.log
  verbose: 1

detection:
  enabled_detectors: [sqli, xss, complexity, protocol]
  sqli_sensitivity: high
  xss_sensitivity: high
  max_query_depth: 10
  max_aliases: 50
```

## ğŸ“Š Desteklenen Log FormatlarÄ±

| Format | Ã–rnek |
|--------|-------|
| Nginx Combined | `127.0.0.1 - - [time] "GET /path HTTP/1.1" 200 1234 "ref" "ua"` |
| Apache Combined | Nginx ile aynÄ± format |
| Apache Common | `127.0.0.1 - - [time] "GET /path HTTP/1.1" 200 1234` |
| Auto | Otomatik tespit |

## ğŸ” Tespit Edilen SaldÄ±rÄ±lar

| SaldÄ±rÄ± | Protokol | Åiddet |
|---------|----------|--------|
| SQL Injection | HTTP, GraphQL, WebSocket | HIGH-CRITICAL |
| XSS | HTTP, WebSocket | MEDIUM-HIGH |
| Complexity Attack | GraphQL | MEDIUM |
| Introspection | GraphQL | LOW |
| Abnormal Methods | HTTP | LOW |
| Header Overflow | HTTP | MEDIUM |

## ğŸ› ï¸ Gereksinimler

| KÃ¼tÃ¼phane | KullanÄ±m | Komut |
|-----------|----------|-------|
| scapy | PCAP yakalama | `pip install scapy` |
| pyyaml | YAML config | `pip install pyyaml` |
| netifaces | Interface listesi | `pip install netifaces` |

## ğŸ“ Proje YapÄ±sÄ±

```
ids/
â”œâ”€â”€ main.py              # CLI entry point
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ dispatcher.py    # Paket yÃ¶nlendirici
â”‚   â”œâ”€â”€ packet.py        # Packet veri yapÄ±sÄ±
â”‚   â”œâ”€â”€ logger.py        # GÃ¼venlik logger
â”‚   â””â”€â”€ config.py        # Config yÃ¶netimi
â”œâ”€â”€ capture/
â”‚   â”œâ”€â”€ base_capture.py  # Base class
â”‚   â”œâ”€â”€ pcap_capture.py  # Scapy ile yakalama
â”‚   â”œâ”€â”€ http_proxy.py    # HTTP Proxy
â”‚   â””â”€â”€ log_parser.py    # Log parser
â”œâ”€â”€ analyzers/
â”‚   â”œâ”€â”€ http_analyzer.py
â”‚   â”œâ”€â”€ graphql_analyzer.py
â”‚   â””â”€â”€ websocket_analyzer.py
â”œâ”€â”€ detectors/
â”‚   â”œâ”€â”€ sqli_detector.py
â”‚   â””â”€â”€ xss_detector.py
â””â”€â”€ simulation/
    â””â”€â”€ traffic_simulator.py
```

## ğŸ“„ Lisans

MIT License

## ğŸ‘¥ KatkÄ±da Bulunma

Pull request'ler kabul edilir. BÃ¼yÃ¼k deÄŸiÅŸiklikler iÃ§in Ã¶nce issue aÃ§Ä±n.
